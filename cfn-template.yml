{
    "Resources": {
        "ROLE": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "RoleName": "cross-account-war-role",
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Principal": {
                                "AWS": "897353564673"
                            },
                            "Action": "sts:AssumeRole"
                        }
                    ]
                },
                "Policies": [
                    {
                        "PolicyName": "CostAuditPolicy",
                        "PolicyDocument": {
                            "Version": "2012-10-17",
                            "Statement": [
                                {
                                    "Sid": "CostAudit",
                                    "Effect": "Allow",
                                    "Action": [
                                        "dms:Describe*",
                                        "dms:List*",
                                        "kafka:Describe*",
                                        "kafka:Get*",
                                        "kafka:List*",
                                        "mq:Describe*",
                                        "mq:List*",
                                        "route53resolver:Get*",
                                        "route53resolver:List*",
                                        "memorydb:Describe*",
                                        "savingsplans:Describe*",
                                        "cloudsearch:Describe*",
                                        "quicksight:Describe*",
                                        "quicksight:List*",
                                        "codepipeline:Get*",
                                        "codepipeline:List*",
                                        "codebuild:List*",
                                        "codebuild:Get*",
                                        "codebuild:Describe*",
                                        "codebuild:BatchGet*",
                                        "codedeploy:List*",
                                        "codedeploy:BatchGet*",
                                        "codedeploy:Get*",
                                        "mediaconnect:Describe*",
                                        "mediaconnect:List*",
                                        "mediaconvert:Describe*",
                                        "mediaconvert:Get*",
                                        "mediaconvert:List*",
                                        "medialive:Describe*",
                                        "medialive:List*",
                                        "mediapackage:Describe*",
                                        "mediapackage:List*",
                                        "mediapackage-vod:Describe*",
                                        "mediapackage-vod:List*",
                                        "mediastore:DescribeObject",
                                        "mediastore:Get*",
                                        "mediastore:List*",
                                        "mediatailor:Describe*",
                                        "mediatailor:Get*",
                                        "mediatailor:List*",
                                        "ec2:Describe*",
                                        "elasticache:Describe*",
                                        "events:Describe*",
                                        "events:List*",
                                        "elasticloadbalancing:Describe*",
                                        "kinesis:List*",
                                        "kinesis:Describe*",
                                        "kinesisanalytics:Describe*",
                                        "kinesisanalytics:List*",
                                        "dynamodb:Describe*",
                                        "dynamodb:List*",
                                        "cloudwatch:Describe*",
                                        "cloudwatch:List*",
                                        "cloudwatch:Get*",
                                        "ecr:GetLifecyclePolicy",
                                        "ecr:GetRepositoryPolicy",
                                        "ecr-public:DescribeRepositories",
                                        "ecr:List*",
                                        "ecr:Describe*",
                                        "lambda:List*",
                                        "lambda:GetPolicy",
                                        "lambda:GetAccountSettings",
                                        "lambda:GetFunctionConfiguration",
                                        "lambda:GetFunctionCodeSigningConfig",
                                        "lambda:GetFunctionConcurrency",
                                        "lambda:GetFunctionConfiguration",
                                        "rds:Describe*",
                                        "rds:ListTagsForResource",
                                        "sqs:Get*",
                                        "sqs:List*",
                                        "firehose:Describe*",
                                        "firehose:List*",
                                        "glacier:Describe*",
                                        "glacier:List*",
                                        "glue:GetDevEndpoint",
                                        "s3:GetBucketPolicy",
                                        "s3:List*",
                                        "network-firewall:Describe*",
                                        "network-firewall:List*",
                                        "elasticfilesystem:Describe*",
                                        "kms:Describe*",
                                        "kms:List*",
                                        "kms:GetKeyRotationStatus",
                                        "kms:GetKeyPolicy",
                                        "elasticmapreduce:List*",
                                        "elasticmapreduce:Describe*",
                                        "es:Describe*",
                                        "es:List*",
                                        "es:Get*",
                                        "aoss:Get*",
                                        "aoss:List*",
                                        "logs:Describe*",
                                        "logs:List*",
                                        "application-autoscaling:Describe*",
                                        "redshift:Describe*",
                                        "backup:Describe*",
                                        "backup:Get*",
                                        "backup:List*",
                                        "dlm:Get*",
                                        "dlm:List*"
                                    ],
                                    "Resource": "*"
                                },
                                {
                                    "Action": [
                                        "billingconductor:List*",
                                        "billing:ListBillingViews"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "BillingReadOnly"
                                },
                                {
                                    "Action": [
                                        "ce:Describe*",
                                        "ce:Get*",
                                        "ce:List*",
                                        "support:Get*",
                                        "support:Describe*"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "CostExplorerAccess"
                                },
                                {
                                    "Action": [
                                        "cur:DescribeReportDefinitions",
                                        "organizations:Describe*",
                                        "organizations:List*"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "CURReportDefinitions"
                                },
                                {
                                    "Action": [
                                        "pricing:*"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "PricingAPIAccess"
                                },
                                {
                                    "Action": [
                                        "wellarchitected:*"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "WellArchitectedAccess"
                                },
                                {
                                    "Action": [
                                        "cognito-idp:List*",
                                        "cognito-idp:Describe*",
                                        "detective:Describe*",
                                        "detective:List*",
                                        "detective:Get*",
                                        "devops-guru:Describe*",
                                        "devops-guru:List*",
                                        "devops-guru:Get*",
                                        "devops-guru:Search*",
                                        "guardduty:Describe*",
                                        "guardduty:Get*",
                                        "guardduty:List*",
                                        "inspector:Describe*",
                                        "inspector:Get*",
                                        "inspector2:List*",
                                        "inspector2:Get*",
                                        "inspector2:Describe*",
                                        "macie2:Describe*",
                                        "macie2:Get*",
                                        "macie2:List*",
                                        "account:Get*",
                                        "account:ListRegions",
                                        "auditmanager:Get*",
                                        "auditmanager:List*",
                                        "controltower:Describe*",
                                        "controltower:Get*",
                                        "controltower:List*",
                                        "sso:Describe*",
                                        "sso:List*",
                                        "sso:Get*",
                                        "sso:Search*",
                                        "sso-directory:Describe*",
                                        "sso-directory:Get*",
                                        "sso-directory:List*",
                                        "sso-directory:Search*",
                                        "aws-marketplace:DescribeAgreement",
                                        "aws-marketplace:Get*",
                                        "aws-marketplace:List*",
                                        "aws-marketplace:ViewSubscriptions",
                                        "aws-marketplace:SearchAgreements",
                                        "networkmanager:DescribeGlobalNetworks",
                                        "networkmanager:Get*",
                                        "networkmanager:List*",
                                        "trustedadvisor:Describe*",
                                        "trustedadvisor:List*",
                                        "cloudtrail:Describe*",
                                        "cloudtrail:Get*",
                                        "cloudtrail:List*",
                                        "cloudtrail:LookupEvents",
                                        "cloudformation:Describe*",
                                        "cloudformation:Get*",
                                        "cloudformation:List*",
                                        "compute-optimizer:Describe*",
                                        "compute-optimizer:Get*",
                                        "config:Describe*",
                                        "config:Get*",
                                        "config:List*",
                                        "ds:Describe*",
                                        "ds:Get*",
                                        "ds:List*",
                                        "fms:Get*",
                                        "fms:List*",
                                        "access-analyzer:Get*",
                                        "access-analyzer:List*",
                                        "healthlake:Describe*",
                                        "healthlake:GetCapabilities",
                                        "healthlake:List*",
                                        "healthlake:ReadResource",
                                        "healthlake:Search*",
                                        "health:Describe*",
                                        "license-manager:Get*",
                                        "license-manager:List*",
                                        "servicecatalog:Describe*",
                                        "servicecatalog:Get*",
                                        "servicecatalog:List*",
                                        "servicecatalog:ScanProvisionedProducts",
                                        "servicecatalog:Search*",
                                        "securityhub:Describe*",
                                        "securityhub:Get*",
                                        "securityhub:List*",
                                        "ssm:Describe*",
                                        "ssm:List*",
                                        "ram:Get*",
                                        "ram:List*",
                                        "servicequotas:Get*",
                                        "servicequotas:List*",
                                        "s3:Describe*",
                                        "license-manager:GetGrant",
                                        "license-manager:ListTokens",
                                        "license-manager-user-subscriptions:List*"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "ReadOnlyForOrgServices"
                                }
                            ]
                        }
                    },
                    {
                        "PolicyName": "SecAuditPolicy",
                        "PolicyDocument": {
                            "Version": "2012-10-17",
                            "Statement": [
                                {
                                    "Sid": "SecAudit",
                                    "Effect": "Allow",
                                    "Action": [
                                        "appsync:List*",
                                        "cloudfront:List*",
                                        "cloudfront:Get*",
                                        "cloudfront:Describe*",
                                        "ecr:DescribeRepositories",
                                        "ecr:BatchGetRepositoryScanningConfiguration",
                                        "iam:List*",
                                        "iam:Get*",
                                        "lambda:GetFunctionConfiguration",
                                        "lambda:GetFunctionUrlConfig",
                                        "inspector2:BatchGetAccountStatus",
                                        "securityhub:GetEnabledStandards",
                                        "s3:List*",
                                        "s3:GetBucket*",
                                        "s3:GetEncryptionConfiguration",
                                        "s3:GetAccountPublicAccessBlock",
                                        "s3:GetEncryptionConfiguration",
                                        "s3:GetLifecycleConfiguration",
                                        "ce:GetCostAndUsage",
                                        "sts:GetCallerIdentity",
                                        "wafv2:List*",
                                        "wafv2:Get*"
                                    ],
                                    "Resource": "*"
                                },
                                {
                                    "Sid": "SecAuditServiceQuotas",
                                    "Effect": "Allow",
                                    "Resource": "*",
                                    "Action": [
                                        "states:List*",
                                        "states:Describe*",
                                        "servicequotas:GetServiceQuota",
                                        "acm:List*",
                                        "acm:DescribeCertificate",
                                        "athena:ListWorkGroups",
                                        "athena:GetWorkGroup",
                                        "apigateway:GET",
                                        "autoscaling:Describe*",
                                        "cloudformation:DescribeAccountLimits",
                                        "cloudformation:DescribeStacks",
                                        "ds:GetDirectoryLimits",
                                        "ec2:Get*",
                                        "ecs:Describe*",
                                        "ecs:List*",
                                        "eks:Describe*",
                                        "eks:List*",
                                        "elasticbeanstalk:DescribeApplicationVersions",
                                        "elasticbeanstalk:DescribeApplications",
                                        "elasticbeanstalk:DescribeEnvironments",
                                        "elasticfilesystem:DescribeFileSystems",
                                        "firehose:ListDeliveryStreams",
                                        "lambda:GetAccountSettings",
                                        "route53:Get*",
                                        "route53:List*",
                                        "servicequotas:List*",
                                        "servicequotas:Get*",
                                        "ses:Get*",
                                        "ses:List*",
                                        "support:Describe*",
                                        "support:SearchForCases",
                                        "trustedadvisor:Describe*",
                                        "trustedadvisor:GenerateReport",
                                        "trustedadvisor:RefreshCheck",
                                        "iam:GenerateCredentialReport",
                                        "secretsmanager:ListSecrets",
                                        "secretsmanager:DescribeSecret",
                                        "sns:List*",
                                        "sns:Get*",
                                        "artifact:ListReports",
                                        "artifact:GetReportMetadata",
                                        "artifact:GetReport",
                                        "artifact:GetTermForReport"
                                    ]
                                },
                                {
                                    "Action": [
                                        "consolidatedbilling:GetAccountBillingRole",
                                        "consolidatedbilling:ListLinkedAccounts",
                                        "billing:Get*",
                                        "payments:ListPaymentPreferences",
                                        "invoicing:GetInvoicePDF",
                                        "invoicing:ListInvoiceSummaries"
                                    ],
                                    "Resource": "*",
                                    "Effect": "Allow",
                                    "Sid": "NewReadAccountBillingPermissions"
                                }
                            ]
                        }
                    }
                ]
            }
        }
    },
    "Outputs": {
        "ROLENAME": {
            "Description": "The following role has been created for cross account access",
            "Value": {
                "Ref": "ROLE"
            }
        },
        "ROLEARN": {
            "Description": "The ARN for the role",
            "Value": {
                "Fn::GetAtt": [
                    "ROLE",
                    "Arn"
                ]
            }
        }
    }
}
